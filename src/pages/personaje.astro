---
import Layout from "../layouts/Layout.astro";
import { CldUploadWidget } from "astro-cloudinary";
---

<Layout title="Spooky Hackaton - Crea tu personaje">
    <main
        class="flex items-center justify-center h-screen w-screen overflow-hidden"
    >
        <div class="relative">
            <img
                src="/img/elements/grave.png"
                alt="Grave"
                class="object-cover h-full max-h-screen w-auto py-4"
            />
            <div
                class="absolute inset-0 bg-opacity-50 flex justify-center items-center"
            >
                <div
                    class="h-2/3 w-[45%] lg:mb-28 flex flex-col items-center text-center"
                >
                    <span
                        class="h-24 w-24 lg:h-60 lg:w-60 rounded-full block border border-white mb-8 cursor-pointer overflow-hidden"
                    >
                        <img
                            id="graveImage"
                            src=""
                            class="w-full h-full object-cover"
                        />
                    </span>
                    <CldUploadWidget
                        id="uploadWidget"
                        uploadPreset="upload-unisgned-images"
                        options={{
                            sources: ["local", "camera"],
                            multiple: false,
                            maxFiles: 1,
                            language: "es",
                            text: {
                                en: {
                                    or: "O",
                                },
                                es: {
                                    menu: {
                                        files: "Mis archivos",
                                        camera: "Cámara",
                                    },
                                    local: {
                                        dd_title_single:
                                            "Arrastra tu imagen aquí",
                                        browse: "Seleccionar",
                                    },
                                    camera: {
                                        capture: "Capturar",
                                        cancel: "Cancelar",
                                        take_pic: "Saca una foto y súbela",
                                        explanation:
                                            "Make sure that your camera is connected and that your browser allows camera capture. When ready, click Capture.",
                                        camera_error:
                                            "Error al acceder a la cámara",
                                        retry: "Volver a intentar",
                                        file_name: "Camera_{{time}}",
                                    },
                                },
                            },
                            styles: {
                                palette: {
                                    window: "#8E8E8E",
                                    windowBorder: "#9356A3",
                                    tabIcon: "#3D224B",
                                    menuIcons: "#5A616A",
                                    textDark: "#000000",
                                    textLight: "#FFFFFF",
                                    link: "#3D224B",
                                    action: "#ADEF13",
                                    inactiveTabIcon: "#3D224B",
                                    error: "#F44235",
                                    inProgress: "#0078FF",
                                    complete: "#20B832",
                                    sourceBg: "#E4EBF1",
                                },
                                frame: {
                                    background: "#0E2F5B99",
                                },
                            },
                        }}
                        ><button class="graven-text mb-4"
                            ><img
                                class="h-8 opacity-50 hover:opacity-100 transition-all duration-200"
                                src="/img/icons/imageUp.svg"
                            /></button
                        ></CldUploadWidget
                    >
                    <h2
                        id="labelNombre"
                        contenteditable="true"
                        class="cursor-pointer text-sm lg:text-3xl graven-text uppercase truncate overflow-hidden max-w-96 text-center focus:outline-none focus:border-b-2 focus:border-trickle-green"
                    >
                        Tu nombre
                    </h2>
                    <span
                        class="graven-text uppercase truncate pt-1 lg:pt-3 text-xs lg:text-2xl flex flex-row"
                    >
                        <input
                            id="inputFnacimiento"
                            type="date"
                            placeholder=""
                            class="appearance-none border-none focus:outline-none focus:border-b-2 focus:border-trickle-green graven-text"
                        /><span class="pt-[2px]"> 22/10/2024</span>
                    </span>
                    <p
                        id="labelPalabras"
                        class="graven-text uppercase text-xs lg:text-2xl text-center px-4 my-auto bottom-0 cursor-pointer max-h-24 overflow-clip"
                    >
                        <span>"</span><span
                            class="focus:outline-none focus:border-b-2 focus:border-trickle-green"
                            contenteditable="true"
                        >
                            FINIS OMNIS VITA MORS EST</span
                        ><span>"</span>
                    </p>
                </div>
            </div>
        </div>
    </main>
</Layout>
<script>
    const widget = document.getElementById("uploadWidget");

    if (widget) {
        widget.addEventListener("clduploadwidget:success", ((
            e: CustomEvent<{ info: { public_id: string; secure_url: string } }>,
        ) => {
            const publicId = e.detail.info.public_id;
            const secure_url = e.detail.info.secure_url;

            // Get the image element
            const graveImage = document.getElementById(
                "graveImage",
            ) as HTMLImageElement;

            // Update the src attribute with the new secure_url
            if (graveImage) {
                graveImage.src = secure_url;
            }
        }) as EventListener);
    }
</script>

<style>
    input[type="date"]::-webkit-calendar-picker-indicator {
        display: none;
        -webkit-appearance: none;
        padding: 0;
    }
    input[type="date"] {
        padding: 0;
        margin: 0;
        border: none;
        background: transparent;
    }

    input[type="date"]::-webkit-datetime-edit,
    input[type="date"]::-webkit-datetime-edit-fields-wrapper,
    input[type="date"]::-webkit-datetime-edit-text,
    input[type="date"]::-webkit-datetime-edit-month-field,
    input[type="date"]::-webkit-datetime-edit-day-field,
    input[type="date"]::-webkit-datetime-edit-year-field {
        padding: 0;
        margin: 0;
    }

    input[type="date"]::-webkit-inner-spin-button,
    input[type="date"]::-webkit-calendar-picker-indicator {
        display: none;
        -webkit-appearance: none;
    }
</style>
